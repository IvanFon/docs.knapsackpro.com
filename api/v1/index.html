<!DOCTYPE HTML><html><head><title>Knapsack Pro API documentation</title><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="https://github.com/kevinrenskers/raml2html 2.0.1"><link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.1/styles/default.min.css"><script type="text/javascript" src="https://code.jquery.com/jquery-1.11.0.min.js"></script><script type="text/javascript" src="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.1/highlight.min.js"></script><script type="text/javascript">
      $(document).ready(function() {
        $('.page-header pre code, .top-resource-description pre code').each(function(i, block) {
          hljs.highlightBlock(block);
        });

        $('[data-toggle]').click(function() {
          var selector = $(this).data('target') + ' pre code';
          $(selector).each(function(i, block) {
            hljs.highlightBlock(block);
          });
        });

        // open modal on hashes like #_action_get
        $(window).bind('hashchange', function(e) {
          var anchor_id = document.location.hash.substr(1); //strip #
          var element = $('#' + anchor_id);

          // do we have such element + is it a modal?  --> show it
          if (element.length && element.hasClass('modal')) {
            element.modal('show');
          }
        });

        // execute hashchange on first page load
        $(window).trigger('hashchange');

        // remove url fragment on modal hide
        $('.modal').on('hidden.bs.modal', function() {
          if(history && history.replaceState) {
            history.replaceState({}, '', '#');
          }
        });
      });
    </script><style>
      .hljs {
        background: transparent;
      }
      .parent {
        color: #999;
      }
      .list-group-item > .badge {
        float: none;
        margin-right: 6px;
      }
      .panel-title > .methods {
        float: right;
      }
      .badge {
        border-radius: 0;
        text-transform: uppercase;
        width: 70px;
        font-weight: normal;
        color: #f3f3f6;
        line-height: normal;
      }
      .badge_get {
        background-color: #63a8e2;
      }
      .badge_post {
        background-color: #6cbd7d;
      }
      .badge_put {
        background-color: #22bac4;
      }
      .badge_delete {
        background-color: #d26460;
      }
      .badge_patch {
        background-color: #ccc444;
      }
      .list-group, .panel-group {
        margin-bottom: 0;
      }
      .panel-group .panel+.panel-white {
        margin-top: 0;
      }
      .panel-group .panel-white {
        border-bottom: 1px solid #F5F5F5;
        border-radius: 0;
      }
      .panel-white:last-child {
        border-bottom-color: white;
        -webkit-box-shadow: none;
        box-shadow: none;
      }
      .panel-white .panel-heading {
        background: white;
      }
      .tab-pane ul {
        padding-left: 2em;
      }
      .tab-pane h2 {
        font-size: 1.2em;
        padding-bottom: 4px;
        border-bottom: 1px solid #ddd;
      }
      .tab-pane h3 {
        font-size: 1.1em;
      }
      .tab-content {
        border-left: 1px solid #ddd;
        border-right: 1px solid #ddd;
        border-bottom: 1px solid #ddd;
        padding: 10px;
      }
      #sidebar {
        margin-top: 30px;
        padding-right: 5px;
        overflow: auto;
        height: 90%;
      }
      .top-resource-description {
        border-bottom: 1px solid #ddd;
        background: #fcfcfc;
        padding: 15px 15px 0 15px;
        margin: -15px -15px 10px -15px;
      }
      .resource-description {
        border-bottom: 1px solid #fcfcfc;
        background: #fcfcfc;
        padding: 15px 15px 0 15px;
        margin: -15px -15px 10px -15px;
      }
      .resource-description p:last-child {
        margin: 0;
      }
      .list-group .badge {
        float: left;
      }
      .method_description {
        margin-left: 85px;
      }
      .method_description p:last-child {
        margin: 0;
      }
      .list-group-item {
        cursor: pointer;
      }
      .list-group-item:hover {
        background-color: #f5f5f5;
      }
    </style></head><body data-spy="scroll" data-target="#sidebar"><div class="container"><div class="row"><div class="col-md-9" role="main"><div class="page-header"><h1>Knapsack Pro API documentation <small>version v1</small></h1><p>http://api.knapsackpro.com/v1</p></div><div class="panel panel-default"><div class="panel-heading"><h3 id="build_subsets" class="panel-title">/build_subsets</h3></div><div class="panel-body"><div class="panel-group"><div class="panel panel-white"><div class="panel-heading"><h4 class="panel-title"><a class="collapsed" data-toggle="collapse" href="#panel_build_subsets"><span class="parent"></span>/build_subsets</a> <span class="methods"><a href="#build_subsets_post"><span class="badge badge_post">post</span></a></span></h4></div><div id="panel_build_subsets" class="panel-collapse collapse"><div class="panel-body"><div class="list-group"><div onclick="window.location.href = '#build_subsets_post'" class="list-group-item"><span class="badge badge_post">post</span><div class="method_description"><p>Endpoint expects partial test suite execution data for particular test build.</p><p>For instance send here data collected after execution half of test suite on the first CI node. Send here also data collected for the second half of the test suite executed on the second CI node.</p><p>We will merge the data automatically to have complete information about the particular build.</p></div><div class="clearfix"></div></div></div></div></div><div class="modal fade" tabindex="0" id="build_subsets_post"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title" id="myModalLabel"><span class="badge badge_post">post</span> <span class="parent"></span>/build_subsets</h4></div><div class="modal-body"><div class="alert alert-info"><p>Endpoint expects partial test suite execution data for particular test build.</p><p>For instance send here data collected after execution half of test suite on the first CI node. Send here also data collected for the second half of the test suite executed on the second CI node.</p><p>We will merge the data automatically to have complete information about the particular build.</p></div><ul class="nav nav-tabs"><li class="active"><a href="#build_subsets_post_request" data-toggle="tab">Request</a></li><li><a href="#build_subsets_post_response" data-toggle="tab">Response</a></li></ul><div class="tab-content"><div class="tab-pane active" id="build_subsets_post_request"><h3>Query Parameters</h3><ul><li><strong>test_suite_token</strong>: <em>required (string)</em><p>Token for the particular test suite. <strong>Token must be kept private.</strong></p><p>For instance token for your RSpec test suite. If you have also test written in Cucumber then you will have separate token for Cucumber test suite.</p><p><strong>Example</strong>:</p><pre>4ae170d5806c331bfab123ca1adaadb3</pre></li><li><strong>commit_hash</strong>: <em>required (string)</em><p>The most recent hash commit in your project.</p><p>You are running tests on the codebase with latest commit pointed to the <strong>commit_hash</strong>.</p><p><strong>Example</strong>:</p><pre>6e3396177d9f8ca87e2b93b4b0a25babd09d574d</pre></li><li><strong>branch</strong>: <em>required (string)</em><p>You are running tests on this branch.</p><p><strong>Example</strong>:</p><pre>master</pre></li><li><strong>node_total</strong>: <em>required (integer)</em><p>Total number of CI nodes you have.</p><p>For instance if you want to parallelize your test suite across 4 servers then <strong>node_total</strong> is 4.</p><p><strong>Example</strong>:</p><pre><code>4</code></pre></li><li><strong>node_index</strong>: <em>required (integer)</em><p>Index of current CI node where part of the test suite where executed.</p><p><strong>node_index</strong> starts from 0 so in case when <strong>node_total</strong> is 4 then max <strong>node_index</strong> is 3.</p></li><li><strong>test_files</strong>: <em>required (string)</em><p>JSON array with objects. Each object contains test file path and execution time for the test file.</p><p>Example contains only part of the test suite. The part of tests was executed on the CI node for specified <strong>node_index</strong>.</p><p><strong>Example</strong>:</p><pre>[
  {
    "path": "test/fast/a_test.rb",
    "time_execution": 0.2015
  },
  {
    "path": "test/fast/b_test.rb",
    "time_execution": 0.04
  },
  {
    "path": "test/slow/c_test.rb",
    "time_execution": 6.2120
  },
  {
    "path": "test/slow/d_test.rb",
    "time_execution": 4.3703
  }
]
</pre></li></ul><h3>Body</h3><p><strong>Type: application/json</strong></p><p><strong>Schema</strong>:</p><pre><code>{
  "test_suite_token": "4ae170d5806c331bfab123ca1adaadb3",
  "commit_hash": "6e3396177d9f8ca87e2b93b4b0a25babd09d574d",
  "branch": "master",
  "node_total": "4",
  "node_index": "0",
  "test_files": [
    {
      "path": "test/fast/a_test.rb",
      "time_execution": 0.2015
    },
    {
      "path": "test/fast/b_test.rb",
      "time_execution": 0.04
    },
    {
      "path": "test/slow/c_test.rb",
      "time_execution": 6.2120
    },
    {
      "path": "test/slow/d_test.rb",
      "time_execution": 4.3703
    }
  ]
}
</code></pre></div><div class="tab-pane" id="build_subsets_post_response"><h2>HTTP status code <a href="http://httpstatus.es/201" target="_blank">201</a></h2><h3>Body</h3><p><strong>Type: application/json</strong></p><p><strong>Example</strong>:</p><pre><code>Response does not contain any data.</code></pre><h2>HTTP status code <a href="http://httpstatus.es/422" target="_blank">422</a></h2><h3>Body</h3><p><strong>Type: application/json</strong></p><p><strong>Example</strong>:</p><pre><code>// example 1
{
  "errors": [
    {
      "branch": ["parameter is required"]
    }
  ]
}

// example 2
{
  "errors": [
    {
      "node_index": ["must be less than or equal to 1"],
      "test_files": [
        {
          "0": {
            "time_execution": ["is not a number"]
          },
          "1": {
            "path": ["is too short (minimum is 3 characters)"]
          }
        }
      ]
    }
  ]
}
</code></pre></div></div></div></div></div></div></div></div></div></div><div class="panel panel-default"><div class="panel-heading"><h3 id="build_distributions" class="panel-title">/build_distributions</h3></div><div class="panel-body"><div class="panel-group"><div class="panel panel-white"><div class="panel-heading"><h4 class="panel-title"><a class="collapsed" data-toggle="collapse" href="#panel_build_distributions_subset"><span class="parent">/build_distributions</span>/subset</a> <span class="methods"><a href="#build_distributions_subset_post"><span class="badge badge_post">post</span></a></span></h4></div><div id="panel_build_distributions_subset" class="panel-collapse collapse"><div class="panel-body"><div class="list-group"><div onclick="window.location.href = '#build_distributions_subset_post'" class="list-group-item"><span class="badge badge_post">post</span><div class="method_description"><p>Endpoint expects a list of all test files in your test suite.</p><p>In response, you will get a list of test files that should be run on a node with particular <strong>node_index</strong> value.</p><p>You will get also <strong>build_distribution_id</strong> (seed) to compare if all your CI nodes are running based on the same test suite split.</p></div><div class="clearfix"></div></div></div></div></div><div class="modal fade" tabindex="0" id="build_distributions_subset_post"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title" id="myModalLabel"><span class="badge badge_post">post</span> <span class="parent">/build_distributions</span>/subset</h4></div><div class="modal-body"><div class="alert alert-info"><p>Endpoint expects a list of all test files in your test suite.</p><p>In response, you will get a list of test files that should be run on a node with particular <strong>node_index</strong> value.</p><p>You will get also <strong>build_distribution_id</strong> (seed) to compare if all your CI nodes are running based on the same test suite split.</p></div><ul class="nav nav-tabs"><li class="active"><a href="#build_distributions_subset_post_request" data-toggle="tab">Request</a></li><li><a href="#build_distributions_subset_post_response" data-toggle="tab">Response</a></li></ul><div class="tab-content"><div class="tab-pane active" id="build_distributions_subset_post_request"><h3>Query Parameters</h3><ul><li><strong>test_suite_token</strong>: <em>required (string)</em><p>Token for the particular test suite. <strong>Token must be kept private.</strong></p><p>For instance token for your RSpec test suite. If you have also test written in Cucumber then you will have separate token for Cucumber test suite.</p><p><strong>Example</strong>:</p><pre>4ae170d5806c331bfab123ca1adaadb3</pre></li><li><strong>fixed_test_suite_split</strong>: <em>(boolean)</em><p>For <code>true</code> value it means when you run test suite again for the same commit hash and total number of nodes and for the same branch then you will get exactly the same test suite split.</p><p>Thanks to that when tests on one of your node failed then you can retry the node with exactly the same subset of tests that were run on the node in the first place.</p><p><strong>Example</strong>:</p><pre><code>true (default)
false
</code></pre></li><li><strong>commit_hash</strong>: <em>required (string)</em><p>The most recent hash commit in your project.</p><p>You are running tests on the codebase with latest commit pointed to the <strong>commit_hash</strong>.</p><p><strong>Example</strong>:</p><pre>6e3396177d9f8ca87e2b93b4b0a25babd09d574d</pre></li><li><strong>branch</strong>: <em>required (string)</em><p>You are running tests on this branch.</p><p><strong>Example</strong>:</p><pre>master</pre></li><li><strong>node_total</strong>: <em>required (integer)</em><p>Total number of CI nodes you have.</p><p>For instance if you want to parallelize your test suite across 4 servers then <strong>node_total</strong> is 4.</p><p><strong>Example</strong>:</p><pre><code>4</code></pre></li><li><strong>node_index</strong>: <em>required (integer)</em><p>Index of current CI node where part of the test suite where executed.</p><p><strong>node_index</strong> starts from 0 so in case when <strong>node_total</strong> is 4 then max <strong>node_index</strong> is 3.</p></li><li><strong>test_files</strong>: <em>required (string)</em><p>JSON array with objects. Each object contains test file path.</p><p>Example contains all test files existing in the test suite.</p><p><strong>Example</strong>:</p><pre>[
  {
    "path": "test/fast/a_test.rb"
  },
  {
    "path": "test/fast/b_test.rb"
  },
  {
    "path": "test/slow/c_test.rb"
  },
  {
    "path": "test/slow/d_test.rb"
  }
]
</pre></li></ul><h3>Body</h3><p><strong>Type: application/json</strong></p><p><strong>Schema</strong>:</p><pre><code>{
  "test_suite_token": "4ae170d5806c331bfab123ca1adaadb3",
  "fixed_test_suite_split": true,
  "commit_hash": "6e3396177d9f8ca87e2b93b4b0a25babd09d574d",
  "branch": "master",
  "node_total": "4",
  "node_index": "0",
  "test_files": [
    {
      "path": "test/fast/a_test.rb"
    },
    {
      "path": "test/fast/b_test.rb"
    },
    {
      "path": "test/slow/c_test.rb"
    },
    {
      "path": "test/slow/d_test.rb"
    }
  ]
}
</code></pre></div><div class="tab-pane" id="build_distributions_subset_post_response"><h2>HTTP status code <a href="http://httpstatus.es/200" target="_blank">200</a></h2><h3>Body</h3><p><strong>Type: application/json</strong></p><p><strong>Example</strong>:</p><pre><code>{
  "build_distribution_id": "4315e028-8a17-4836-8748-42071389d48f",
  "node_index": 0,
  "test_files": [
    {
      "path": "test/fast/b_test.rb",
      "time_execution": null
    },
    {
      "path": "test/slow/d_test.rb",
      "time_execution": 3.14
    }
  ]
}
</code></pre></div></div></div></div></div></div></div></div></div></div><div class="panel panel-default"><div class="panel-heading"><h3 id="queues" class="panel-title">/queues</h3></div><div class="panel-body"><div class="panel-group"><div class="panel panel-white"><div class="panel-heading"><h4 class="panel-title"><a class="collapsed" data-toggle="collapse" href="#panel_queues_queue"><span class="parent">/queues</span>/queue</a> <span class="methods"><a href="#queues_queue_post"><span class="badge badge_post">post</span></a></span></h4></div><div id="panel_queues_queue" class="panel-collapse collapse"><div class="panel-body"><div class="list-group"><div onclick="window.location.href = '#queues_queue_post'" class="list-group-item"><span class="badge badge_post">post</span><div class="method_description"><p>Endpoint expects a list of all test files in your test suite.</p><p>In response, you will get a list of test files that should be run on a node with particular <strong>node_index</strong> value. The CI node can request this endpoint multiple times til it gets an empty list of test files which means the end of the queue.</p><p>You will get also <strong>queue_name</strong> to compare if all your CI nodes are running against the same test suite queue created for particular CI build.</p></div><div class="clearfix"></div></div></div></div></div><div class="modal fade" tabindex="0" id="queues_queue_post"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title" id="myModalLabel"><span class="badge badge_post">post</span> <span class="parent">/queues</span>/queue</h4></div><div class="modal-body"><div class="alert alert-info"><p>Endpoint expects a list of all test files in your test suite.</p><p>In response, you will get a list of test files that should be run on a node with particular <strong>node_index</strong> value. The CI node can request this endpoint multiple times til it gets an empty list of test files which means the end of the queue.</p><p>You will get also <strong>queue_name</strong> to compare if all your CI nodes are running against the same test suite queue created for particular CI build.</p></div><ul class="nav nav-tabs"><li class="active"><a href="#queues_queue_post_request" data-toggle="tab">Request</a></li><li><a href="#queues_queue_post_response" data-toggle="tab">Response</a></li></ul><div class="tab-content"><div class="tab-pane active" id="queues_queue_post_request"><h3>Query Parameters</h3><ul><li><strong>test_suite_token</strong>: <em>required (string)</em><p>Token for the particular test suite. <strong>Token must be kept private.</strong></p><p>For instance token for your RSpec test suite. If you have also test written in Cucumber then you will have separate token for Cucumber test suite.</p><p><strong>Example</strong>:</p><pre>4ae170d5806c331bfab123ca1adaadb3</pre></li><li><strong>can_initialize_queue</strong>: <em>required (boolean)</em><p>The first request from each CI nodes should set this field to <code>true</code> so the first coming request to Knapsack Pro API will initialize queue on the API side.</p><p>All next requests from each CI node should set this field to <code>false</code> so thanks to that when the queue will be empty on API side then the CI nodes will know that should finish work instead of initializing another queue.</p><p><strong>Example</strong>:</p><pre><code>true
false
</code></pre></li><li><strong>fixed_queue_split</strong>: <em>(boolean)</em><p>For <code>true</code> value it means when you run test suite again for the same commit hash and total number of nodes and for the same branch then you will get exactly the same test suite split as on the last dynamic queue split for particular CI build.</p><p>Thanks to that when tests on one of your node failed then you can retry the node with exactly the same subset of tests that were run on the node in the first place.</p><p><strong>Example</strong>:</p><pre><code>true
false (default)
</code></pre></li><li><strong>commit_hash</strong>: <em>required (string)</em><p>The most recent hash commit in your project.</p><p>You are running tests on the codebase with latest commit pointed to the <strong>commit_hash</strong>.</p><p><strong>Example</strong>:</p><pre>6e3396177d9f8ca87e2b93b4b0a25babd09d574d</pre></li><li><strong>branch</strong>: <em>required (string)</em><p>You are running tests on this branch.</p><p><strong>Example</strong>:</p><pre>master</pre></li><li><strong>node_total</strong>: <em>required (integer)</em><p>Total number of CI nodes you have.</p><p>For instance if you want to parallelize your test suite across 4 servers then <strong>node_total</strong> is 4.</p><p><strong>Example</strong>:</p><pre><code>4</code></pre></li><li><strong>node_index</strong>: <em>required (integer)</em><p>Index of current CI node where part of the test suite where executed.</p><p><strong>node_index</strong> starts from 0 so in case when <strong>node_total</strong> is 4 then max <strong>node_index</strong> is 3.</p></li><li><strong>node_build_id</strong>: <em>required (string)</em><p>It is the unique number of the build on CI server.</p><p><strong>node_build_id</strong> can be integer or string.</p><p><strong>Example</strong>:</p><pre>1234</pre></li><li><strong>test_files</strong>: <em>required (string)</em><p>JSON array with objects. Each object contains test file path.</p><p>Example contains all test files existing in the test suite.</p><p><strong>Example</strong>:</p><pre>[
  {
    "path": "test/fast/a_test.rb"
  },
  {
    "path": "test/fast/b_test.rb"
  },
  {
    "path": "test/slow/c_test.rb"
  },
  {
    "path": "test/slow/d_test.rb"
  }
]
</pre></li></ul><h3>Body</h3><p><strong>Type: application/json</strong></p><p><strong>Schema</strong>:</p><pre><code>{
  "test_suite_token": "4ae170d5806c331bfab123ca1adaadb3",
  "can_initialize_queue": true,
  "fixed_queue_split": false,
  "commit_hash": "6e3396177d9f8ca87e2b93b4b0a25babd09d574d",
  "branch": "master",
  "node_total": "4",
  "node_index": "0",
  "node_build_id": "1234",
  "test_files": [
    {
      "path": "test/fast/a_test.rb"
    },
    {
      "path": "test/fast/b_test.rb"
    },
    {
      "path": "test/slow/c_test.rb"
    },
    {
      "path": "test/slow/d_test.rb"
    }
  ]
}
</code></pre></div><div class="tab-pane" id="queues_queue_post_response"><h2>HTTP status code <a href="http://httpstatus.es/200" target="_blank">200</a></h2><h3>Body</h3><p><strong>Type: application/json</strong></p><p><strong>Example</strong>:</p><pre><code>{
  "queue_name": "1:6baacadcdd493c1a6024ee7e51f018f5",
  "build_subset_id": null,
  "test_files": [
    {
      "path": "test/slow/d_test.rb",
      "time_execution": 3.14
    },
    {
      "path": "test/fast/b_test.rb",
      "time_execution": null
    }
  ]
}
</code></pre></div></div></div></div></div></div></div></div></div></div></div><div class="col-md-3"><div id="sidebar" class="hidden-print affix" role="complementary"><ul class="nav nav-pills nav-stacked"><li><a href="#build_subsets">/build_subsets</a></li><li><a href="#build_distributions">/build_distributions</a></li><li><a href="#queues">/queues</a></li></ul></div></div></div></div></body></html>